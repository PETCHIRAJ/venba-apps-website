---
import { Lock, Zap, Smartphone, Cloud, Calculator, Receipt, TrendingUp, PiggyBank } from 'lucide-astro';

export interface Props {
  icon: string;
  name: string;
  category: string;
  features?: string[];
  description?: string;
  storeLink?: string | null;
  status: 'available' | 'coming-soon';
  isPlaceholder?: boolean;
}

const { icon, name, category, features, description, storeLink, status, isPlaceholder = false } = Astro.props;

// Map feature text to icons
const getFeatureIcon = (feature: string) => {
  // Privacy Expense Tracker icons
  if (feature.includes('Encrypted') || feature.includes('storage')) return Lock;
  if (feature.includes('3-tap') || feature.includes('quick')) return Zap;
  if (feature.includes('offline')) return Smartphone;
  if (feature.includes('Drive') || feature.includes('backup')) return Cloud;

  // Home Loan Calculator icons
  if (feature.includes('EMI') || feature.includes('prepayment') || feature.includes('calculator')) return Calculator;
  if (feature.includes('Tax') || feature.includes('benefits')) return Receipt;
  if (feature.includes('Compare') || feature.includes('bank') || feature.includes('rates')) return TrendingUp;
  if (feature.includes('Save') || feature.includes('lakhs') || feature.includes('strategies')) return PiggyBank;

  return null;
};

// Determine button text based on link type
const isWebApp = storeLink && !storeLink.includes('play.google.com');
const buttonText = isWebApp ? 'Visit the app' : 'Available on Google Play Store';
---

<div class="app-card">
    {isPlaceholder ? (
        <div class="placeholder-icon">ðŸš€</div>
    ) : (
        <img src={icon} alt={name} class="app-icon">
    )}
    <h3>{name}</h3>
    {!isPlaceholder && <p class="category">{category}</p>}

    {description && <p>{description}</p>}

    {features && features.length > 0 && (
        <div class="features-list">
            {features.map((feature, index) => {
                const IconComponent = getFeatureIcon(feature);
                return (
                    <div class="feature-item" key={index}>
                        {IconComponent && <IconComponent size={16} class="feature-icon" />}
                        <span>{feature}</span>
                    </div>
                );
            })}
        </div>
    )}

    {storeLink ? (
        <a href={storeLink} target="_blank" rel="noopener noreferrer" class="app-store-link">
            <p class={`status ${status}`}>
                {status === 'available' ? buttonText : 'Coming Soon'}
            </p>
        </a>
    ) : (
        <p class={`status ${status}`}>
            {status === 'available' ? buttonText : 'Coming Soon'}
        </p>
    )}
</div>